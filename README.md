# FNN Text Classifier

## About
This is a GitHub adaptation of my project done as an assignment for the Statistical Language Processing seminar
in the Summer Semester of 2024 at the University of TÃ¼bingen. I changed it a bit and made command-line ready.

This software is a FeedForward Network for text classification task, classifying texts according to the labels provided
by the label map file. The software uses SpaCy models to preprocess text data and generate tensors for training. For
now, it natively supports German-language data and classifies trains German-language classifier models, but there
exists a possibility to use other languages.

The network natively uses [10kGNAD](https://tblock.github.io/10kGNAD/) dataset to perform supervised training for text
classification according to 9 labels:
1. Web - internet
2. Panorama - panorama
3. International - international
4. Wirtschaft - economy
5. Sport - sport
6. Inland - internal affairs
7. Etat - budget
8. Wissenschaft - science
9. Kultur - culture

It is possible to use different datasets, label maps, embeddings and SpaCy models for training.

## Contents of the repository
Repository contains
1. `README.md` file: the file you're reading right now.
2. `Data` directory containing label map file, pre-trained embeddings file, dev, test and training data splits. Here you're going
to find the tensor files generated by the preprocessor as well. IF YOU WANT TO USE THE NETWORK FOR OTHER DATA THAN GERMAN,
THE NEW DATA SPLITS, EMBEDDINGS AND LABELS SHOULD BE PLACED HERE. 
3. `Models` directory containing the models trained by the network. By default there is a baseline model created by my
lecturers
4. `UnitTestData` directory containing data for unit testing. If you change the test cases significantly, make sure you
made changes in the directory too.
5. `constants.py` file containing the keys for saving/loading tensor/model files.
6. `preprocessor.py` file with code to preprocess the data and generate dev, test, and training tensors.
7. `trainer.py` file that trains the models.
8. `grid_search.py` file that finds the best parameters for models.
9. `test_preprocessor.py`, `test_trainer.py` and `test_evaluator.py` files to perform unit testing.

## User's Manual
### Step I: Preprocessing
Make sure you have all the desired data in the `Data` directory. Then, in terminal, change directory to the project directory:\
`cd /path/FFN-Text-Classifier`

After that you run the command to get the dev tensors:
````
python preprocessor.py --data_file Data/[YOUR DEV DATA FILE].csv --label_map_file Data/[YOUR LABEL MAP FILE].json 
--output_file Data/dev-tensors.pt --embeddings_file Data/[YOUR EMBEDDINGS FILE] --spacy_model 
[SPACY MODEL OF YOUR CHOICE, DEFAULT=de_core_news_sm]`
````

You can alternatively use `-d` for `--data_file`, `-l` for `--label_map_file`, `-s` for `--output_file`, `-m` for `--spacy_model`
and `-e` for `--embeddings_file`. Argument `--spacy_model` is optional, but keep in mind that the default SpaCy model
is `de_core_news_sm`, for the German language.

For the training and test tensors, you run analogical command, but instead of dev data file,
you should use test or train data file respectively and in output file you should specify that the file
is going to be for test or training tensors.

### Step II: Training
To train your model, run this command:
````
python trainer.py --train_tensor_file [YOUR TRAINING TENSOR FILE FROM PREPROCESSING].pt --dev_tensor_file [YOUR DEV 
TENSOR FILE FROM PREPROCESSING].pt --hidden_size [HIDDEN SIZE OF YOUR CHOICE, DEFAULT=8] --n_epochs [NUMBER OF TRAINING
EPOCHS OF YOUR CHOICE, DEFAULT=200] --learning_rate [LEARNING RATE OF YOUR CHOICE FOR THE OPTIMISER, DEFAULT=0.01]
--output_model Models/[YOUR MODEL NAME]
````
Alternatively you can use these flags `-t` for `--train_tensor_file`, `-d` for `--dev_tensor_file`, `-h` for
`--hidden_size`, `-n` for `--n_epochs`, `-l` for `--learning_rate`, `-s` for `--output_model`.

### Step III: Model evaluation
To evaluate your model, run this command:
````
python evaluator.py --model Models/[MODEL TO LOAD].pt --tensors Data/[TRAINING, DEV or TEST TENSORS FILE].pt
````
Alternatively you can use these flags `-m` for `--model`, `-t` for `--tensors`.

### Step IV: Retraining with `grid_search.py`:
If you want to retrain your model with the hyperparameters found by `grid_search.py`, run this command:
````
python grid_search.py --data_dev Data/[YOUR DEV TENSORS FILE FROM PREPROCESSOR].pt --data_test [YOUR TEST TENSORS FROM 
PREPROCESSOR] --data_train Data/[YOUR TRAINING TENSORS FILE FROM PREPROCESSOR].pt --output_file Models/[BEST MODEL FILENAME].pt
````
The software will find the best parameters using grid search and then train a new model using the found hyperparameters
and the test tensors and then save it. Default path to the best model is `Models/best-model.pt`.

Alternatively you can use these flags `-dev` for `--data_dev`, `-test` for `--data_test`, `-train` for `--data_train`,
`-s` (s for "save") for `--output_file`.